Java的内存回收基本都是由JVM提供的垃圾回收机制帮我们处理，虽然大部分情况下我们不需要自己手动去释放内存，但了解底层是怎么做的有利于我们平时开发中问题定位。

一般来说，垃圾回收需要考虑下面几个问题：

（1）哪些内存需要回收？

（2）什么时候回收？

（3）如何回收？

另外根据前面Java内存的知识，堆中主要存放实例对象，而方法区（JDK8叫元空间）则主要存放的是常量和静态变量，所以垃圾收集的区域就集中在这两块，主要是堆。

### 1、判断对象可以回收

垃圾收集器在回收对象之前，首先就需要判断对象是否可以回收，需要回收的对象就是不会再被使用的对象。关于判断对象是否可被回收，一般有两种方法：

（1）**引用计数法**

每个对象都有一个引用计数器，当对象被引用时，计数器值加1；引用失效时，计数器值减1。当计数器的值为0时，说明对象不再被使用。

这种方法思想很简单，但可能会存在**相互引用**的问题，所以主流的Java虚拟机都没有使用这种方法来管理内存。

（2）**可达性分析**

这个算法的基本思路是通过一系列“GC Root”根对象作为起点，从这些节点开始，根据引用关系往下搜索，搜索过程中走过的路径称为“引用链”。如果某个对象到“GC Root”之间没有任何引用链，则说明这个对象不可达，不能被使用。

![image-20220111230620774](2、垃圾收集器与内存分配.assets/image-20220111230620774-1913582.png)

一般来说，适合作为GC Root的对象包括下面几种

