#### 397. 整数替换

#### 2021-11-19 LeetCode每日一题

链接：https://leetcode-cn.com/problems/integer-replacement/

标签：**数学、位运算**

> 题目

给定一个正整数 n ，你可以做如下操作

- 如果 n 是偶数，则用 n / 2替换 n 。
- 如果 n 是奇数，则可以用 n + 1或n - 1替换 n 。

n 变为 1 所需的最小替换次数是多少？ 

示例 1：

```java
输入：n = 8
输出：3
解释：8 -> 4 -> 2 -> 1
```

示例 2：

```java
输入：n = 7
输出：4
解释：7 -> 8 -> 4 -> 2 -> 1
或 7 -> 6 -> 3 -> 2 -> 1
```

示例 3：

```java
输入：n = 4
输出：2
```


提示：

- 1 <= n <= 2 ^ 31 - 1

> 分析

对于偶数来说，只有一种选择。对于奇数来说可以加1或者减1。转换为二进制，我们最后就是要让n变成二进制(0000....001)。

对于奇数来说，其二进制的最低位肯定是1，那么如果次低位为0的话，进行加1操作会把最低位置0而次低位置1。如果最低位和次低位都是1，那么加1操作则会把这两位都置0，第三位置1。也就是会把低位上连续的1进行消除，然后把后面那位置1。对于有连续1的情况，加1能够消除低位连续1，所以能加1优先加1。

> 编码

```java
class Solution {
    public int integerReplacement(int n) {
        if (n == Integer.MAX_VALUE) {
            return 32;
        }

        int ans = 0;
        while (n != 1) {
            // 偶数直接变成n / 2
            if (n % 2 == 0) {
                n >>= 1;
            } else {
                // n为3的时候，3 -> 2 -> 1比3 -> 4 -> 2 -> 1快
                if (n != 3 && ((n & 3) == 3)) {
                    n++; 
                } else {
                    n--;
                }
            }
            ans++;
        }

        return ans;
    }
}
```

![image-20211119203938823](397.整数替换.assets/image-20211119203938823.png)